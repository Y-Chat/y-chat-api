asyncapi: 2.5.0
info:
  title: Y-Chat Notification API
  version: 1.0.0
  description: |
    Y-Chat Notification API
defaultContentType: application/json
servers:
  dev:
    url: localhost:28092
    protocol: kafka
channels:
  notification-notification:
    publish:
      summary: Create new notification
      operationId: createNotification
      message:
        $ref: '#/components/messages/NotificationMessage'
    subscribe:
      summary: Received a new notification
      operationId: onNotification
      message:
        $ref: '#/components/messages/NotificationMessage'
components:
  messages:
    NotificationMessage:
      name: transactionMessage
      payload:
        $ref: '#/components/schemas/Notification'
  schemas:
    Notification:
      type: object
      properties:
        newMessage:
          type:  object
          required:
            - chatId
          properties:
            chatId:
              type: string
              format: ObjectId
        updatedMessage:
          type:  object
          required:
            - chatId
            - messageId
          properties:
            chatId:
              type: string
              format: ObjectId
            messageId:
              type: string
              format: ObjectId
        mediaUploaded:
          type:  object
          required:
            - chatId
            - messageId
            - mediaId
          properties:
            chatId:
              type: string
              format: ObjectId
            messageId:
              type: string
              format: ObjectId
            mediaId:
              type: string
              format: ObjectId
        transactionComplete:
          type: object
          required:
            - chatId
            - messageId
            - transactionId
          properties:
            chatId:
              type: string
              format: ObjectId
            messageId:
              type: string
              format: ObjectId
            transactionId:
              type: string
              format: ObjectId
        signalingNewOffer:
          type: object
          required:
            - callId
            - callerId
            - offer
          properties:
            callId:
              type: string
              format: ObjectId
            callerId:
              type: string
              format: ObjectId
            offer:
              $ref: '#/components/schemas/SignalingOffer'
        signalingNewAnswer:
          type: object
          required:
            - callId
            - calleeId
            - answer
          properties:
            callId:
              type: string
              format: ObjectId
            calleeId:
              type: string
              format: ObjectId
            answer:
              $ref: '#/components/schemas/SignalingAnswer'
        signalingNewCandidate:
          type: object
          required:
            - callId
          properties:
            callId:
              type: string
              format: ObjectId
            offerCandidate:
              $ref: '#/components/schemas/SignalingCandidate'
            answerCandidate:
              $ref: '#/components/schemas/SignalingCandidate'
    SignalingOffer:
      type: object
      required:
        - type
      properties:
        sdp:
          type: string
        type:
          type: string
    SignalingAnswer:
      type: object
      required:
        - type
      properties:
        sdp:
          type: string
        type:
          type: string
    SignalingCandidate:
      type: object
      properties:
        candidate:
          type: string
        sdpMLineIndex:
          type: number
        sdpMid:
          type: string
        usernameFragment:
          type: string
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string