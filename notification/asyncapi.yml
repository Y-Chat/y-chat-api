asyncapi: 3.0.0
info:
  title: Y-Chat Notification API
  version: 1.0.0
  description: |
    Y-Chat Notification API
defaultContentType: application/json
servers:
  dev:
    host: 'localhost:28092'
    protocol: kafka
channels:
  notification-notification:
    address: notification-notification
    messages:
      createNotification.message:
        $ref: '#/components/messages/NotificationMessage'
      onNotification.message:
        $ref: '#/components/messages/NotificationMessage'
operations:
  createNotification:
    action: receive
    channel:
      $ref: '#/channels/notification-notification'
    summary: Create new notification
    messages:
      - $ref: '#/channels/notification-notification/messages/createNotification.message'
  onNotification:
    action: send
    channel:
      $ref: '#/channels/notification-notification'
    summary: Received a new notification
    messages:
      - $ref: '#/channels/notification-notification/messages/onNotification.message'
components:
  securitySchemes:
    certs:
      type: X509
  messages:
    NotificationMessage:
      name: transactionMessage
      payload:
        $ref: '#/components/schemas/Notification'
  schemas:
    Notification:
      type: object
      properties:
        newMessage:
          type: object
          required:
            - chatId
          properties:
            chatId:
              type: string
              format: ObjectId
        updatedMessage:
          type: object
          required:
            - chatId
            - messageId
          properties:
            chatId:
              type: string
              format: ObjectId
            messageId:
              type: string
              format: ObjectId
        mediaUploaded:
          type: object
          required:
            - chatId
            - messageId
            - mediaId
          properties:
            chatId:
              type: string
              format: ObjectId
            messageId:
              type: string
              format: ObjectId
            mediaId:
              type: string
              format: ObjectId
        transactionComplete:
          chatId:
            type: string
            format: ObjectId
          messageId:
            type: string
            format: ObjectId
          transactionId:
            type: string
            format: ObjectId
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string
